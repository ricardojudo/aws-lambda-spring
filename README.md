# Background

This is a basic example of how to implement an AWS lambda function with Spring Boot. 

The example relies on the project Spring Cloud functions which is intented to define a programatic model for writing serverless functions capable to run on diferent engines, including AWS Lambda functions.

# Basic structure

## SpringBootLambdaHandler

Entry point of the execution. This handler initializes the spring context and delegates the core to a `java.util.function.Function` instance

## Function implementation

This is a `java.util.function.Function` bean within the Spring Context. It defines the parameter and result types through generic types and should implements the apply method where the programmatic logic is written.  

Since an instance of this class is created by Spring, is possible to inject dependencies through the different injection mechanisms (@Autowired, @Bean, XML)


# pom.xml file

Some dependencies and configurations should be included in the pom.xml files

## Dependencies

```
	<dependency>
		<groupId>org.springframework.cloud</groupId>
		<artifactId>spring-cloud-function-adapter-aws</artifactId>
		<version>2.1.1.RELEASE</version>
	</dependency>
	<dependency>
		<groupId>com.amazonaws</groupId>
		<artifactId>aws-lambda-java-core</artifactId>
		<version>1.2.0</version>
	</dependency>
	<dependency>
		<groupId>com.amazonaws</groupId>
		<artifactId>aws-lambda-java-events</artifactId>
		<version>2.2.6</version>
	</dependency>
```

## Plugin configurations

The following configuration is required in order to build a suitable package to deploy in AWS.

```
	<plugin>
		<groupId>org.apache.maven.plugins</groupId>
		<artifactId>maven-deploy-plugin</artifactId>
		<configuration>
			<skip>true</skip>
		</configuration>
	</plugin>
	<plugin>
		<groupId>org.springframework.boot</groupId>
		<artifactId>spring-boot-maven-plugin</artifactId>
		<dependencies>
			<dependency>
				<groupId>org.springframework.boot.experimental</groupId>
				<artifactId>spring-boot-thin-layout</artifactId>
				<version>${wrapper.version}</version>
			</dependency>
		</dependencies>
	</plugin>
	<plugin>
		<groupId>org.apache.maven.plugins</groupId>
		<artifactId>maven-shade-plugin</artifactId>
		<configuration>
			<createDependencyReducedPom>false</createDependencyReducedPom>
			<shadedArtifactAttached>true</shadedArtifactAttached>
			<shadedClassifierName>aws</shadedClassifierName>
		</configuration>
	</plugin>

```



# Deployment in the AWS console

The package archive is generated by running maven with

```
	mvn clean package
```

The deployable artifact is target/aws-lambda-spring-0.0.1-SNAPSHOT-aws.jar, which is a lean packaged version suitable to run on AWS.

![Alt Lambda function deployment](docs/aws-console-1.png?raw=true "Lambda function deployment")

Notice that is required to set the handler value with the full qualified name of the `SpringBootRequestHandler`implementation

# Testing 

Just define a test event with a string value through the console and test.

![Alt Lambda function testing](docs/aws-console-2.png?raw=true "Lambda function testing")